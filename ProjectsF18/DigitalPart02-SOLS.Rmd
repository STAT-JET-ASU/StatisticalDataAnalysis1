---
title: "Digital Communication, Part 2"
author: "SOLUTIONS"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: 
  html_document: 
    highlight: textmate
    theme: cosmo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = "")
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```

```{r, message=FALSE}
# load all packages and datasets here
library(tidyverse)
```

<hr>

1) In Part 1, you analyzed error rates for a single-channel system and a TRC system. One way to reduce transmission errors in either system would be to improve the initial 1% error rate. How xbarch would reducing the error rate improve the performance of the TRC system? Create a plot that shows error rates from 0% to 1% (in increments of 0.1) on the x-axis versus the corresponding probability that any single TRC block (e.g., 000) is interpreted correctly (y-axis). To what value do we have to reduce the initial error rate in order for the probability of a block being correctly transmitted to be at least 99.99%?

```{r}
rates <- seq(from = 0, to = 0.01, by = .001)
block <- pbinom(1, 3, 1 - rates, lower.tail = FALSE)
ggplot(NULL, aes(x = rates, y = block)) +
  geom_point() +
  geom_hline(yintercept = 0.9999, color = "red") +
  labs(x = "single channel error rate", y = "chance of TRC success")
```

ANSWER: The single channel error rate needs to be reduced to 0.005 (i.e., cut in half).


2) A 1000 Mbit/s system transmits 10^9^ bits per second. Each bit has a 0.03% chance of being incorrectly received when we use TRC and all bits are independent. There are are 86,400 seconds in a day. If X is the number of incorrect bits in a single second, use `rbinom` to simulate the distribution of X for a single day. Assess your simulation results for normality using a density plot, ECDF plot, QQ plot, and goodness of fit test. What do you conclude?

Simulation:
```{r}
errors <- rbinom(86400, 10^9, 0.0003)
xbar <- mean(errors)
stdv <- sd(errors)

ggplot(NULL, aes(x = errors)) + 
  geom_density() +
  stat_function(fun = dnorm, 
                args = list(xbar, stdv),   
                color = "red")

ggplot(NULL, aes(x = errors)) + 
  stat_ecdf() +
  stat_function(fun = pnorm, 
                args = list(xbar, stdv), 
                color = "red")

ggplot(NULL, aes(sample = errors)) + 
  stat_qq() +
  stat_qq_line(color = "red")
```

Ho: The errors are normally distributed.

Ha: The errors are not normally distributed.

Goodness of Fit Test:
```{r}
errorscat <- case_when(errors <= xbar - 2*stdv ~ "C1",
                       errors <= xbar - 1*stdv & errors > xbar - 2*stdv ~ "C2",
                       errors <= xbar - 0*stdv & errors > xbar - 1*stdv ~ "C3",
                       errors <= xbar + 1*stdv & errors > xbar - 0*stdv ~ "C4",
                       errors <= xbar + 2*stdv & errors > xbar + 1*stdv ~ "C5",
                       errors >  xbar + 2*stdv ~ "C6")

observed <- table(errorscat)
prop.table(observed)

# Find theoretical probabilities for the intervals.

probs <- c(pnorm(-2), 
           pnorm(-1) - pnorm(-2), 
           pnorm(0) - pnorm(-1), 
           pnorm(1) - pnorm(0), 
           pnorm(2) - pnorm(1), 
           pnorm(2, lower.tail=F))

chisq.test(observed, p = probs)
```

Conclusions: We fail to reject Ho at the &alpha; = 0.05 level and conclude that the errors are normally distributed. This is supported by the plots; in each case the simulated distribution closely follows the theoretical curves.


<hr>

END PART 2