---
title: "MSRR CH02, Sections 1-3 HW"
author: "SOLUTIONS"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: 
  html_document: 
    theme: yeti
    highlight: textmate
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, comment = "")
```

***

**Instructions**

Complete the following problems from _Mathematical Statistics with Resampling and R_. You can access the textbook datasets on our [Class Data Files](https://stat-jet-asu.github.io/Datasets/DatasetList.html) page or from the `R` package `resampledata`. The textbook examples use base `R`code for plotting, but you `ggplot2` for visualizations. You may use `table()` to make tables, but you should use `dplyr` for other summaries. Refer to the case studies in Chapter 1 to add informative titles and axis labels to your plots and to provide context for your answers.

Load the packages and datasets you need here.

```{r}
library(dplyr)
library(ggplot2)
library(resampledata)
```

Nonlinear transformations change the spacing of the data on the real number line, so f(statistic(x)) is not equal to statistic(f(x)).


***
#### Problem 2.1

Note: Test for equality using code, not just visual inspection.

```{r}
# basic solution
data    <- c(3, 5, 8, 15, 20, 21)
logdata <- log(data)
xbar_data <- mean(data)
med_data  <- median(data)
xbar_logdata <- mean(logdata)
med_logdata  <- median(logdata)
log(xbar_data) == xbar_logdata
log(med_data) == median(logdata)

# solution using dplyr
summary1 <- tibble(data = c(3, 5, 8, 15, 20, 21)) %>% 
  mutate(logdata = log(data)) %>% 
  summarize(xbar_data         = mean(data),
            med_data          = median(data),
            xbar_logdata      = mean(logdata),
            med_logdata       = median(logdata),
            test_equal_mean   = log(xbar_data) == xbar_logdata,
            test_equal_median = log(med_data) == median(logdata))
glimpse(summary1)   # using glimpse because of long variable names
```

Nonlinear transformations change the spacing of the data on the real number line, so f(statistic(x)) is not equal to statistic(f(x)). 


***
#### Problem 2.2

Note: Test for equality using code, not just visual inspection.

```{r}
data     <- c(1, 2, 4, 5, 6, 8, 11, 15)
sqrtdata <- sqrt(data)
xbar_data <- mean(data)
med_data  <- median(data)
xbar_sqrtdata <- mean(sqrtdata)
med_sqrtdata  <- median(sqrtdata)
log(xbar_data) == xbar_sqrtdata
log(med_data) == median(sqrtdata)

# solution using dplyr
summary2 <- tibble(data = c(1, 2, 4, 5, 6, 8, 11, 15)) %>% 
  mutate(sqrtdata = sqrt(data)) %>% 
  summarize(xbar_data         = mean(data),
            med_data          = median(data),
            xbar_sqrtdata     = mean(sqrtdata),
            med_sqrtdata      = median(sqrtdata),
            test_equal_mean   = sqrt(xbar_data) == xbar_sqrtdata,
            test_equal_median = sqrt(med_data) == median(sqrtdata))
glimpse(summary2)   # using glimpse because of long variable names
```


***
#### Problem 2.5

Note: In (c), create the table of proportions you need to answer (d) as well as a table of counts.

Part (a)

```{r}
# using base
table(GSS2002$DeathPenalty)

# using dplyr
GSS2002 %>% count(DeathPenalty)

ggplot(GSS2002, aes(DeathPenalty)) + 
  geom_bar(fill = "lightblue", color = "darkgray") +
  labs(title = "People convicted of murder should be subject to the death penalty.",
       caption = "source: MSRR GSS2002 dataset",
       x = "Survey Responses",
       y = "Number of Respondents")
```

Part (b)

```{r}
table(GSS2002$OwnGun)
summary(GSS2002$OwnGun)
```

ANSWER: The summary shows the NA values while the table does not.

Part (c)

```{r}
table(GSS2002$OwnGun, GSS2002$DeathPenalty)
prop.table(table(GSS2002$OwnGun, GSS2002$DeathPenalty), 1)
```

Part (d)

ANSWER: They appear different. About 80% of gun owners favor the death penalty versus about 65% of non gun owners.


***
#### Problem 2.6

Note: In (b), create a table of proportions as well as a table of counts to answer the question. In (c), also compute the upper fence for each group to show the upper cutoff for outliers.

Part (a)

```{r}
# using base
table(Recidivism$Recid)

# using dplyr
Recidivism %>% count(Recid)

ggplot(Recidivism, aes(Recid)) + 
  geom_bar(fill = "lightblue", color = "darkgray") +
  labs(title = "Incidence of Recidivism Among Iowa Prisoners",
       subtitle = "All Misdemeanor and Felony Offenders Released in FY2010",
       caption = "source: MSRR Recidivism dataset",
       x = "Did they recidivate?",
       y = "Number of Prisoners")
```

Part (b)

```{r}
# using base
table(Recidivism$Age25, Recidivism$Recid)
prop.table(table(Recidivism$Age25, Recidivism$Recid), 1)

# using dplyr
Recidivism %>% 
  filter(complete.cases(Age25)) %>% 
  count(Recid, Age25)

Recidivism %>% 
  filter(complete.cases(Age25)) %>% 
  group_by(Age25) %>% 
  summarize(prop_yes = mean(Recid == "Yes"))
```

Part (c)

```{r}
ggplot(Recidivism, aes(x = Offense, y = Days)) + 
  geom_boxplot(fill = "lightgreen") +
  labs(title = "Days to Recidivism Among Iowa Prisoners",
       subtitle = "Offenders Released in FY2010 Who Did Recidivate",
       caption = "source: MSRR Recidivism dataset",
       x = "Type of Violation",
       y = "Number of Days to Recidivism")
```

Comparison 1: The groups seem to have similar minimums, Q1, and maximum values.

Comparison 2: The median is the misdemeanor group seems to be slightly larger.

Comparison 3: There are no outliers in either group.

Overall, the distributions appear to be similar in shape, center, and spread.

Part (d)

```{r}
# using base
quantile(Recidivism$Days, c(0.25, 0.50, 0.75), na.rm = TRUE)

# using dplyr
Recidivism %>% 
  summarize(Q1  = quantile(Days, 0.25, na.rm = TRUE),
            Med = quantile(Days, 0.50, na.rm = TRUE),
            Q3  = quantile(Days, 0.75, na.rm = TRUE))

# extra, by groups to go with boxplot
Recidivism %>% 
  filter(complete.cases(Age25)) %>% 
  group_by(Age25) %>% 
  summarize(Q1  = quantile(Days, 0.25, na.rm = TRUE),
            Med = quantile(Days, 0.50, na.rm = TRUE),
            Q3  = quantile(Days, 0.75, na.rm = TRUE))
```

Part (e)

```{r}
Recidivism %>% 
  filter(complete.cases(Age25)) %>% 
  ggplot(aes(x = Days, color = Age25)) +
  stat_ecdf() +
  geom_vline(xintercept = 400) +
  geom_hline(yintercept = c(.46, .53), color = "gray")   # eyeball estimates of intersections
```

ANSWER: Of those who recidivated, about 53% of those under 25 did so on or before 400 days, versus about 46% of those 25 and over. (The variable label says "Over 25" but the description in Chapter 1 states that the group is actually 25 and over.)


***

```{r}
sessionInfo()
```

