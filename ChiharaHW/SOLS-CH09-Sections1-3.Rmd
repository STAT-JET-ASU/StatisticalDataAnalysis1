---
title: "MSRR CH09, Sections 1-3 HW"
author: "SOLUTIONS / Jill E. Thomley"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: 
  html_document: 
    theme: yeti
    highlight: textmate
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, comment = "")
```

***

**Instructions**

Complete the following problems from _Mathematical Statistics with Resampling and R_. You can access the textbook datasets on our [Class Data Files](https://stat-jet-asu.github.io/Datasets/DatasetList.html) page or from the `R` package `resampledata`. The textbook examples use base `R`code for plotting, but you `ggplot2` for visualizations. You may use `table()` to make tables, but you should use `dplyr` for other summaries. Refer to the case studies in Chapter 1 to add informative titles and axis labels to your plots and to provide context for your answers.

Load the packages and datasets you need here.

```{r}
library(dplyr)
library(ggplot2)
library(resampledata)
```


***
#### Problem 9.6

Part (a) 

```{r}
corr1 <- Olympics2012 %>% 
  summarize(correlation = cor(Height, Weight))
corr1
```

Part (b)

Note: For "What do you observe?", comment on linearity, direction of trend, and outliers.

```{r}
ggplot(Olympics2012, aes(x = Height, y = Weight)) +
  geom_point() +
  geom_jitter() +
  labs(title = "Height vs. Weight of Selected 2012 Olympic Athletes",
       x = "Height (inches)",
       y = "Weight (pounds)",
       caption = "source: MSRR Olympics2012 dataset")
```

ANSWER: There seems to be a positive linear trend where weight increases with height. There are some outliers, people who are unusually heavy compared to others of the same height.

Part (c)

Hint: Use `filter()` with `Weight` to remove the outliers.

```{r}
corr2 <- Olympics2012 %>% 
  filter(Weight < 250) %>% 
  summarize(correlation = cor(Height, Weight))
corr_diff <- corr2 - corr1
corr_diff
```

ANSWER: The correlation increased by about `r round(corr_diff, 3)`, so the outliers appear to haver been influential.

Reminder: You can embed the value of a calculated object like `corr_diff` in the text of your answer rather than typing it by hand. This enhances reprodicibility. See the **Basic R Markdown Cheat Sheet > 5. Embed Code > inline code**.

```{r}
# extra--note you can filter a dataset inside ggplot2
# the trend looks a little less straight in this plot
ggplot(filter(Olympics2012, Weight < 250), aes(x = Height, y = Weight)) +
  geom_point() +
  geom_jitter() +
  labs(title = "Height vs. Weight of Selected 2012 Olympic Athletes",
       subtitle = "note: bivariate outliers with weights over 250 pounds removed",
       x = "Height (inches)",
       y = "Weight (pounds)",
       caption = "source: MSRR Olympics2012 dataset")
```


***
#### Problem 9.8

Part (a)

```{r}
# coloring by team is extra, to help visualize correlation difference
ggplot(RangersTwins2016, aes(x = BA, y = RBI, color = Team)) +
  geom_point() +
  geom_jitter() +
  labs(title = "RBI versus BA for Texas Rangers and Minnesota Twins in 2016",
       x = "batting average (BA)",
       y = "runs batted in (RBI)",
       caption = "source: MSRR RangersTwins2016")

RangersTwins2016 %>% 
  summarize(correlation = cor(BA, RBI))
```

Part (b)

```{r}
RangersTwins2016 %>% 
  group_by(Team) %>% 
  summarize(correlation = cor(BA, RBI))
```

ANSWER: The Rangers alone had a stronger correlation than the combined teams, while the Twins had a weaker correlation. (But, neither relationship seems strictly linear.)


***
#### Problem 9.9

Part (a)

```{r}

```

Part (b)

```{r}

```

Part (c)

```{r}

```

Part (d)

ANSWER: 


***
#### Problem 9.16

Note: In (b), create a table of proportions as well as a table of counts to answer the question. In (c), also compute the upper fence for each group to show the upper cutoff for outliers.

Part (a)

```{r}

```

Part (b)

```{r}

```

INTERPRETATION:

Part (c)

```{r}

```

Part (d) ADDED Perform a residual analysis like [MD 6.1.4](https://moderndive.com/6-regression.html#model1) and comment on the appropriateness of a straight-line model. 

```{r}

```

ANSWER:


***

```{r}
sessionInfo()
```

