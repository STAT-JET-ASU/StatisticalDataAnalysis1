---
title: "Vietnam Draft Data Activity, Part 1"
author: "Instructor: Jill E. Thomley (thomleyje@appstate.edu)"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: 
  html_document: 
    highlight: textmate
    theme: cosmo
---

<hr>

### The Problem

In December 1969, the U.S. Selective Service System conducted a lottery to a determine draft order for eligible men in the upcoming year. The 366 days of the year (including February 29) were written on small pieces of paper. Each was placed in a plastic capsule, then the capsules were hand-mixed in a shoebox and dumped in a glass jar. Capsules were pulled out one at a time. The first number chosen was 258 (September 14). Anyone born on that day in 1944 through 1950 was assigned lottery number 1. The first 195 birthdates drawn were later called to serve in the order they were drawn. Some people asserted that the numbers were not randomly distributed through the year, in particular when you compared the first half and second half of the year.

![Representative Alexander Pirnie (R-NY) drawing the first draft number. Image is public domain.](https://stat-jet-asu.github.io/Moodlepics/draftlottery1968.jpg)

```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)

draftdata <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/vietnamdraft.csv")
```


```{r}
str(draftdata)
glimpse(draftdata)
summary(draftdata)
```


### Overall Distribution of Draft Numbers

```{r, chunkname}
summaryA <- draftdata %>% summarize(observations = n(),
                                    average      = mean(num1970),
                                    standarddev  = sd(num1970),
                                    minimum      = min(num1970),
                                    maximum      = max(num1970))

print.data.frame(summaryA)

ggplot(draftdata, aes(x = num1970)) + 
  geom_histogram(aes(y=..density..), breaks = seq(from = 0, to = 366), fill = "lightblue") +
  ggtitle("Discrete Uniform Distribution 1 to 366, probability = 1/366")  +
  xlab("draft number") +
  ylab("probability")

ggplot(draftdata, aes(x = num1970)) + 
  geom_density(fill = "lightblue") +
  ggtitle("Smoothed Density Plot of Draft Numbers")
```


### Distribution of Draft Numbers by Half-Year

```{r}
summaryH <- draftdata %>% 
  group_by(halfyear) %>%
  summarize(observations = n(),
            average      = mean(num1970),
            standarddev  = sd(num1970),
            minimum      = min(num1970),
            maximum      = max(num1970))

print.data.frame(summaryH)

ggplot(draftdata, aes(x = num1970, fill = halfyear)) + 
  geom_density(alpha = 0.3) +
  scale_fill_manual(values = c("red", "yellow")) +
  ggtitle("Smoothed Density Plots of Draft Numbers for Each Half-Year")
```


### Distribution of Draft Numbers by Month

```{r}
draftdata$month <- factor(draftdata$month, levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))

summaryM <- draftdata %>% 
  group_by(month) %>%
  summarize(observations = n(),
            average      = mean(num1970),
            standarddev  = sd(num1970),
            minimum      = min(num1970),
            maximum      = max(num1970))

print.data.frame(summaryM)

ggplot(summaryM, aes(x = month, y = average)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  geom_errorbar(aes(ymin = average - standarddev/sqrt(observations), 
                    ymax = average + standarddev/sqrt(observations)), 
                width=.1) +
  ggtitle("Mean Draft Number by Month with Standard Error") +
  ylab("mean +/- SE")

ggplot(draftdata, aes(x = month, y = num1970)) + 
  geom_boxplot(fill = "lightgreen") +
  ggtitle("Boxplots of Draft Numbers by Month for 1970") +
  ylab("draft number")

ggplot(draftdata, aes(x = 1:366, y = num1970)) +
  geom_point() +
  geom_smooth() +
  xlab("order by birthday") +
  ylab("draft number")
```

