---
title: "Describing Distributions<br>&#9654; Categorical Data"
author: "Author: Jill E. Thomley"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: ioslides_presentation
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(comment="", message=FALSE, warning=FALSE)
```

## 

<p style="text-align: center;">![](http://www-history.mcs.st-andrews.ac.uk/BigPictures/Fisher.jpeg)</p>

<p>"...the object of statistical methods is the reduction of data. A quantity of data, which usually by its mere bulk is incapable of entering the mind, is to be replaced by relatively few quantities which shall adequately represent the whole, or...shall contain as much as possible, ideally the whole, of the relevant information contained in the original data." ~ R.A. Fisher, 1921</p>


## Describing Distributions

__categorial variables__

* __frequency__
* __relative frequency__

quantitative variables

* shape
* center
* spread
* outliers

Shape, center, and spread characterize the pattern of values or observations. Outliers are deviations from the pattern.


## Exploring Categorical Data

* frequency table
* relative frequency table
* cumulative frequency table
* cumulative relative frequency table
* contingency table
* [bar chart / barplot](https://ggplot2.tidyverse.org/reference/geom_bar.html)
* ~~pie chart~~

“There is no data that can be displayed in a pie chart that cannot be displayed better in some other type of chart.” (some attribute this to John Tukey, but that cannot be verified)


## Frequency Tables

In the 1970s, University of California Berkeley was sued for sex discrimination in graduate school admissions. The [berkeley.csv](https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/berkeley.csv) dataset contains fall 1973 data for the six largest departments.

```{r echo=FALSE}
berkdata <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/berkeley.csv")
```

```{r}
summary(berkdata)
```

For space, I hid the `read.csv` code used to import the data and name it `berkdata`  by using echo=FALSE in the R code chunk.


## Using `table()` and `prop.table()`

```{r}
table(berkdata$sex)   # frequencies
prop.table(table(berkdata$sex))   # relative frequencies
round(prop.table(table(berkdata$sex)), 4)   # rounded for display
```


## Contingency (Two-Way) Tables

```{r}
table(berkdata$sex, berkdata$status)
prop.table(table(berkdata$sex, berkdata$status), 1)
```

What happens if you use 2 instead of 1 in `prop.table` above?


## Using `dplyr` to Make "Tables"

```{r}
library(dplyr)
berkdata %>% count(sex)
```

The `table()` function produces a named vector or matrix. The method above produces a `tibble`.

Some functions such as `chisq.test()` expect vector or matrix input, so consider the purpose of the summary.


## Cumulative Tables 

```{r}
berkdata %>% 
  count(department) %>% 
  arrange(desc(n)) %>% 
  mutate(cum_n    = cumsum(n),
         prop     = prop.table(n),
         cum_prop = cumsum(prop))
```


## Using `dplyr` for Two Variables

```{r}
berkdata %>% 
  count(sex, status)
```


## &nbsp;

```{r}
library(tidyr)
berkdata %>% 
  count(sex, status) %>% 
  spread(status, n)
```

This form can aid summarizing and visualizing, but is it `tidy`?


## Barplots for One Variable

```{r fig.height=4}
library(ggplot2)
ggplot(berkdata, aes(x = sex)) + geom_bar()
```


## Improve the Presentation

```{r fig.height=3.4}
ggplot(berkdata, aes(x = sex)) + 
  geom_bar(fill = "lightblue") +
  labs(title = "Berkeley Admissions Data",
       x = "sex of applicant")
```


## Barplots for Two Variables

```{r fig.height=4.25}
ggplot(berkdata, aes(x = sex, fill = status)) + geom_bar()
```


## Proportions vs. Counts

```{r fig.height=3.65}
ggplot(berkdata, aes(x = sex, fill = status)) + 
  geom_bar(position = "fill") +
  labs(y = "proportion")
```


## Barplots from Summarized Data

We can still make a barplot if we have summarized vs. raw data.

```{r fig.height=3}
dept_tab <- berkdata %>% count(department)
ggplot(dept_tab, aes(x = department, y = n)) + 
  geom_bar(stat = "identity")
```


## Barplots Without a Data Frame

```{r fig.height=3}
classyear <- factor(c("FR", "SO", "JR", "SR"),
                    levels = c("FR", "SO", "JR", "SR"))
students  <- c(254, 223, 219, 185)
ggplot(NULL, aes(x = classyear, y = students)) + 
  geom_bar(stat = "identity")
```


## More About Color

The online _Cookbook for R_ shows some [color options](http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/) and built-in color palettes for plots. You can use colors by name (if it has one that R recognizes, use `colors()` function to see a list), hex code, or rgb value (e.g., [HTML Color Codes](https://htmlcolorcodes.com/color-names/) or [ColorHexa](https://www.colorhexa.com/)).

* _color_ typically refers to points, lines, outlines
* _fill_ typically refers to some internal shading

```{r eval=FALSE}
ggplot(berkdata, aes(x = sex, fill = status)) +
  geom_bar(color = "darkgray") +
  scale_fill_manual(values = c("palegreen", "turquoise")) +
  labs(title = "Berkeley Admissions Data",
       subtitle = "Largest Six Departments, Fall 1973",
       caption = "data = berkeley.csv",
       x = "sex of applicant",
       y = "number of applicants")
```


## A Custom Color Example

```{r echo=FALSE}
ggplot(berkdata, aes(x = sex, fill = status)) +
  geom_bar(color = "darkgray") +
  scale_fill_manual(values = c("palegreen", "turquoise")) +
  labs(title = "Berkeley Admissions Data",
       subtitle = "Largest Six Departments, Fall 1973",
       caption = "data = berkeley.csv",
       x = "sex of applicant",
       y = "number of applicants")
```


## Three Variables?

```{r echo=FALSE}
ggplot(berkdata, aes(x = sex, fill = status)) +
  geom_bar(color = "darkgray") +
  facet_grid(. ~ department) +
  scale_fill_manual(values = c("palegreen", "turquoise")) +
  labs(title = "Berkeley Admissions Data",
       subtitle = "Largest Six Departments, Fall 1973",
       caption = "data = berkeley.csv",
       x = "sex of applicant",
       y = "number of applicants")
```
