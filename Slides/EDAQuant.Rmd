---
title: "Describing Distributions<br>&#9654; Quantitative Data"
author: "Author: Jill E. Thomley"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: ioslides_presentation
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(comment="", message=FALSE, warning=FALSE)
```

## &nbsp;



"If we need a short suggestion of what exploratory data analysis is, I would suggest that


* It is an attitude AND

* A flexibility AND

* Some graph paper (or transparencies, or both)."

<p>~ John Tukey, 1980</p>


## How We Describe Distributions

categorial variables

* frequency
* relative frequency

__quantitative variables__

* __shape__
* __center__
* __spread__
* __outliers__

Shape, center, and spread characterize the pattern of values or observations. Outliers are deviations from the pattern.


## Shape

* how many modes?
    * unimodal
    * bimodal
    * multimodal
* symmetric or skewed?
    * right skewed
    * left skewed
* skewness (quantification of asymmetry)
* kurtosis (conformation of peak and tails)

We rely heavily on plots to assess shape. Summary measures like skewness and kurtosis should be interpeted _with_ plots.


## Plots for Assessing Shape

* histogram
    * [geom_histogram()](https://ggplot2.tidyverse.org/reference/geom_histogram.html)
* density plot
    * [geom_density()](https://ggplot2.tidyverse.org/reference/geom_density.html)
* empirical cumulative distribution plot
    * [stat_ecdf()](https://ggplot2.tidyverse.org/reference/stat_ecdf.html)
* boxplot
    * [geom_boxplot()](https://ggplot2.tidyverse.org/reference/geom_boxplot.html)

See AsULearn Statistics Terms & Concepts glossary and course textbooks for more information on plots and summaries.

    
## Some Data to Plot

Load [gasmileage.csv](https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/gasmileage.csv) and [oldfaithful.csv](https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/oldfaithful.csv) into RStudio. Let's plot! 

```{r, echo=FALSE}
mileage <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/gasmileage.csv")
geyser  <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/oldfaithful.csv")
```

```{r}
library(dplyr)
glimpse(mileage)
glimpse(geyser)
```


## Basic Histogram

```{r, fig.height=4}
library(ggplot2)
ggplot(mileage, aes(x = mpg)) + geom_histogram()
```


## &nbsp;

```{r, fig.height=4.3}
ggplot(geyser, aes(x = wait_time)) + geom_histogram()
```


## Rules of Thumb for Number of Bins

* between 5 and 15 bins
* between 5 and 20 bins
* number of bins near the square root of the sample size n
* Sturge’s rule, number of bins around 1 + 3.322 × log(n)
* Freedman-Diaconis rule, about 2 × IQR × n^(−1/3) bins

Finding the right binwidth is an interative process. You can set an approximate number of bins, a specific bin width, or exact boundaries you want for the bins.

The default number of bins is 30.

https://ggplot2.tidyverse.org/reference/geom_histogram.html


## Basic Density

```{r, fig.height=4.3}
ggplot(mileage, aes(x = mpg)) + geom_density()
```


## &nbsp;

```{r, fig.height=4.3}
ggplot(geyser, aes(x = wait_time)) + geom_density()
```


## Density Over Histogram

```{r, fig.height=3.7}
ggplot(mileage, aes(x = mpg)) + 
  geom_histogram(aes(y=..density..)) + 
  geom_density()
```


## &nbsp;

```{r, fig.height=3.7}
ggplot(geyser, aes(x = wait_time)) + 
  geom_histogram(aes(y=..density..)) + 
  geom_density()
```


## Empirical Cumulative Distribution

```{r, fig.height=4.3}
ggplot(mileage, aes(x = mpg)) + stat_ecdf()
```


## Density and ECDF

```{r, fig.height=3.7}
ggplot(mileage, aes(x = mpg)) + 
  geom_density() + 
  stat_ecdf()
```


## Skewness and Kurtosis

```{r}
library(moments)
skewness(mileage$mpg)
kurtosis(mileage$mpg)
kurtosis(mileage$mpg) - 3
```

We will discuss more about connections between measures in upcoming slides.


## Center

* mean
    * arithmetic mean ("average", _expected value_)
    * geometric mean
    * weighted mean
    * trimmed mean
* median
* mode (we use this more with reference to shape)

Mean and median are both the "middle" of a given distribution, but the two summaries define middle differently. Video lesson "Measures of Center and Spread" discusses this in more depth.


## Spread

* variance
    * population
    * sample
* standard deviation
* mean absolute deviation (mad)
* median absolute deviation (_also_ mad?)
* interquartile range (IQR)
* range

Summarizing the deviations of a set of values from some center point is a common technique in statistics. 


## Measures Based on Moments

In physics, a moment of force is the turning effect of the force about a central point, as a function of distance from the point. Statistical moments are a similar idea.

mean (first moment)

* the mean $\mu$ is the value that makes $\Sigma(X - \mu)^1 = 0$ true
* mean is the center of mass or _balance point_ of a distribution

variance (second moment)

$$M_2 = \frac{\Sigma(X - \mu)^2}{n} = \sigma^2$$ 

$$\text{standard deviation} = \sigma $$


## &nbsp;

skewness (third moment)

$$M_3 = \frac{\Sigma(X - \mu)^3}{n}$$

$$skewness = \frac{\Sigma(X - \mu)^3}{\sigma^3}$$

kurtosis (fourth moment)

$$M_4 = \frac{\Sigma(X - \mu)^4}{n}$$

$$kurtosis = \frac{\Sigma(X - \mu)^4}{\sigma^4}$$


## Moment-Based Summaries in R

* `mean()`
* `var()`
* `sd()`
* `skewness()`
* `kurtosis()`
* `mad()` (not a moment, but a related concept)

Skewness and kurtosis require the `moments` package. You should explore the syntax, parameters, and output of each function.


## Measures Based on Ordered Counts

* five-number-summary
    * minimum
    * first quartile (Q<sub>1</sub>)
    * median
    * third quartile (Q<sub>3</sub>)
    * maximum
* interquartile range (IQR)
* range
* percentiles / quantiles


## Count-Based Summaries in R

* `fivenum()`
* `min()`
* `median()`
* `max()`
* `IQR()`
* `range()`
* `quantile()`

Again, you should explore the syntax, parameters, and output of each function to understand how it works.


## Boxplots and Outliers

One of the most common rules for determining outliers is based on the five-number summary. We can visualize the five-number summary and outliers in a boxplot.

<p style="text-align: center"><img src="https://stat-jet-asu.github.io/Moodlepics/boxplot.png"></p>


## Calculating the Fences

```{r}
lowerFence <- fivenum(mileage$mpg)[2] - 1.5 * IQR(mileage$mpg)
print(lowerFence)
upperFence <- fivenum(mileage$mpg)[4] + 1.5 * IQR(mileage$mpg)
print(upperFence)
boxplot.stats(sort(mileage$mpg))[4]
```


## Boxplot for One Variable

```{r, fig.height=4.3}
ggplot(mileage, aes(x = 1, y = mpg)) + geom_boxplot()
```


## Comparing Groups

Load the [FlightDelays.csv](https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Chihara/FlightDelays.csv) dataset into RStudio. Let's compare!

```{r, echo=FALSE}
CO2 <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Chihara/FlightDelays.csv")
```

```{r}
glimpse(CO2)
```


## Comparative Boxplots

```{r, fig.height=4.3}
ggplot(CO2, aes(x = Carrier, y = FlightLength)) + geom_boxplot()
```


## More TBA

Additional slides will be added!


## &nbsp;

http://www.cookbook-r.com/Graphs/