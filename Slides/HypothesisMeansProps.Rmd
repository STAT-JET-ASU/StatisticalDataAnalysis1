---
title: "Hypothesis Testing:<br>Means or Proportions"
author: "Author: Jill E. Thomley"
date: 'Updated: `r format(Sys.time(), "%A, %B %d, %Y @ %X")`'
output: ioslides_presentation
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(comment="", message=FALSE, warning=FALSE)
library(dplyr)
library(ggplot2)
```

## Before You Begin

Complete the following video lessons on AsULearn. They will introduce you to the logical framework of hypothesis testing and traditional asymptotic hypothesis tests for the population value of one mean or proportion, as well as for comparing two populations means or proportions.

* Theory and Concepts of Hypothesis Testing
* Classical Hypothesis Testing for One Mean
* Classical Hypothesis Testing for Two Means
* Classical Hypothesis Testing for Proportions


# Comparing Two Means

## Null and Alternative Hypotheses

The hypotheses for a test comparing means are written in terms of the population means $\mu$.

null hypothesis

$$H_0: \mu_1 = \mu_2 \text{ or } H_0: \mu_1 - \mu_2 = 0$$

alternative hypothesis (two-tailed, lower-tailed, or upper-tailed)

$$H_a: \mu_1 \neq \mu_2 \text{ (or } H_a: \mu_1 - \mu_2 \neq 0)$$

$$H_a: \mu_1 < \mu_2 \text{ (or } H_a: \mu_1 - \mu_2 < 0)$$

$$H_a: \mu_1 > \mu_2 \text{ (or } H_a: \mu_1 - \mu_2 > 0)$$


## Traditional Test for Two Means

assumptions

* independent simple random samples from the populations
* normally distributed populations (or large enough samples)

test statistic (unpooled)

$$t=\frac{\bar{x}_1-\bar{x}_2}{\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}}$$

The p-value is calculated using a _t_ distribution with $\nu$ degrees of freedom, which depends on the sample sizes.

In R, we use `t.test()` to perform a test for two means.


## Comparing Two Means Example

Do brand name or generic batteries last longer?  ([batterylife.csv](https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/batterylife.csv))

```{r, echo=FALSE}
battery <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/batterylife.csv")
```

```{r}
str(battery)
summaries <- battery %>% 
  group_by(type) %>% 
  summarize(n = n(), xbar = mean(hours), stdv = sd(hours))
print.data.frame(summaries, row.names = FALSE)
```

## Are there any outliers in the data?

```{r, echo=FALSE}
ggplot(battery, aes(x = type, y = hours)) + geom_boxplot()
```


## Are the data normally distributed?

```{r, echo=FALSE}
ggplot(battery, aes(sample = hours, color = type)) + stat_qq() + stat_qq_line()
```

## Tests for Two Means

Open the R Markdown file [Comparing Two Means](https://raw.githubusercontent.com/STAT-JET-ASU/StatisticalDataAnalysis1/master/ComparingTwoMeans.Rmd) to continue.


# Comparing Proportions

## Null and Alternative Hypotheses

The hypotheses for a test comparing proportions are written in terms of the population proportions $\pi$.

null hypothesis

$$H_0: \pi_1 = \pi_2 \text{ or } H_0: \pi_1 - \pi_2 = 0$$

alternative hypothesis (two-tailed, lower-tailed, or upper-tailed)

$$H_a: \pi_1 \neq \pi_2 \text{ (or } H_a: \pi_1 - \pi_2 \neq 0)$$

$$H_a: \pi_1 < \pi_2 \text{ (or } H_a: \pi_1 - \pi_2 < 0)$$

$$H_a: \pi_1 > \pi_2 \text{ (or } H_a: \pi_1 - \pi_2 > 0)$$


## Traditional Two-Proportion Test

assumptions

* independent simple random samples from the populations
* large enough sample sizes for the normal approximation to the binomial to be valid (one rule is np > 10 and n(1-p) = 10)

test statistic 

$$z=\frac{p_1-p_2}{\sqrt{p(1-p)(\frac{1}{n_1}+\frac{1}{n_2})}}$$

The p-value is calculated using the standard normal distribution.

In R, we use `prop.test()` to conduct a test for two proportions.


## Comparing Proportions Example

Do magnets affect homing pigeons' skills?  ([homingpigeons.csv](https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/homingpigeons.csv))

```{r, echo=FALSE}
homing <- read.csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/homingpigeons.csv")
```

```{r}
str(homing)
summaries <- homing %>% 
  group_by(group) %>% summarize(n = n(), 
                                p_hat_y = mean(home == "no"), 
                                p_hat_n = mean(home == "yes"))
```

```{r, echo=FALSE}
print.data.frame(summaries, row.names = FALSE)
```

## Visualize the Proportions

```{r, echo=FALSE}
ggplot(homing, aes(x = group, fill = home)) + geom_bar(position = "fill") + ylab("proportion")
```


## Are np > 10 and n(1-p) > 10?

```{r, echo=FALSE}
print.data.frame(summaries, row.names = FALSE)
```

```{r}
summaries$n * summaries$p_hat_y >= 10
summaries$n * summaries$p_hat_n >= 10
```


## Tests for Two Proportions

Continue using R Markdown file [Comparing Two Proportions](https://raw.githubusercontent.com/STAT-JET-ASU/StatisticalDataAnalysis1/master/ComparingTwoProportions.Rmd).